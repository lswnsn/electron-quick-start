{"version":3,"file":"main.js","mappings":"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","sources":["webpack://@oamcu/web/./apps/vcu-offline/src/app/app.ts","webpack://@oamcu/web/./apps/vcu-offline/src/app/events/electron.events.ts","webpack://@oamcu/web/./apps/vcu-offline/src/app/events/squirrel.events.ts","webpack://@oamcu/web/./apps/vcu-offline/src/environments/environment.ts","webpack://@oamcu/web/./libs/offline-backend-shared/src/lib/utils/logger.ts","webpack://@oamcu/web/external commonjs \"electron\"","webpack://@oamcu/web/external commonjs \"electron-log\"","webpack://@oamcu/web/external node-commonjs \"child_process\"","webpack://@oamcu/web/external node-commonjs \"fs\"","webpack://@oamcu/web/external node-commonjs \"os\"","webpack://@oamcu/web/external node-commonjs \"path\"","webpack://@oamcu/web/webpack/bootstrap","webpack://@oamcu/web/webpack/runtime/compat get default export","webpack://@oamcu/web/webpack/runtime/define property getters","webpack://@oamcu/web/webpack/runtime/hasOwnProperty shorthand","webpack://@oamcu/web/webpack/runtime/make namespace object","webpack://@oamcu/web/./apps/vcu-offline/src/main.ts"],"sourcesContent":["import { BrowserWindow, shell, screen, ipcMain } from 'electron';\r\nimport { environment } from '../environments/environment';\r\nimport path from 'path';\r\nimport { fork, ChildProcess } from 'child_process';\r\nimport ErrnoException = NodeJS.ErrnoException;\r\nconst os = require('os');\r\nconst fs = require('fs');\r\n\r\nlet forkedProcess: ChildProcess;\r\nexport default class App {\r\n\r\n    static mainWindow: Electron.BrowserWindow;\r\n    static application: Electron.App;\r\n    static BrowserWindow: typeof BrowserWindow;\r\n\r\n    public static isDevelopmentMode() {\r\n        const isEnvironmentSet: boolean = 'ELECTRON_IS_DEV' in process.env;\r\n        // @ts-ignore\r\n        const getFromEnvironment: boolean = parseInt(process.env.ELECTRON_IS_DEV, 10) === 1;\r\n\r\n        return isEnvironmentSet ? getFromEnvironment : !environment.production;\r\n    }\r\n\r\n    private static onWindowAllClosed() {\r\n        console.log(`!!on onWindowAllClosed!!!`);\r\n        App.application.quit();\r\n\r\n    }\r\n\r\n    private static onClose() {\r\n        // @ts-ignore\r\n        App.mainWindow = null;\r\n    }\r\n\r\n    private static onRedirect(event: any, url: string) {\r\n        if (url !== App.mainWindow.webContents.getURL()) {\r\n            event.preventDefault();\r\n            shell.openExternal(url);\r\n        }\r\n    }\r\n\r\n    private static onReady() {\r\n        App.initMainWindow();\r\n        App.loadMainWindow();\r\n    }\r\n\r\n    private static onActivate() {\r\n        if (App.mainWindow === null) {\r\n            App.onReady();\r\n        }\r\n    }\r\n\r\n    private static initMainWindow() {\r\n        const workAreaSize = screen.getPrimaryDisplay().workAreaSize;\r\n        const iconPath = process.platform === 'linux' ?\r\n            path.join(__dirname, 'assets/static', '256x256.png') : path.join(__dirname, 'assets/static', 'favicon.ico');\r\n\r\n        // Create the browser window.\r\n        App.mainWindow = new BrowserWindow({\r\n            width: workAreaSize.width,\r\n            height: workAreaSize.height,\r\n            show: false,\r\n            icon: iconPath,\r\n            webPreferences: {\r\n                nodeIntegration: true,\r\n                contextIsolation: false,\r\n                backgroundThrottling: false\r\n            },\r\n        });\r\n        App.mainWindow.setMenu(null);\r\n        App.mainWindow.center();\r\n\r\n        App.mainWindow.once('ready-to-show', () => {\r\n            App.mainWindow.show();\r\n        });\r\n\r\n        App.mainWindow.on('closed', () => {\r\n            // @ts-ignore\r\n            App.mainWindow = null;\r\n        });\r\n    }\r\n\r\n    private static loadMainWindow() {\r\n\r\n        const indexPath = path.resolve(__dirname, `assets/main.js`);\r\n        console.log(`index path is ${indexPath}`);\r\n        forkedProcess = fork(indexPath, ['--static', 'static']);\r\n        forkedProcess.on('message', (message: string) => {\r\n            console.log(`Received message from forked process \"${message}\"`);\r\n            if (message.startsWith('SERVER_UP')) {\r\n                const data = message.split('_');\r\n                const portNumber = data[data.length-1];\r\n                const directoryPath = `${os.homedir()}/vcu-offline-data`;\r\n                const saveWnlsDataHandler = (event: unknown, wnlsContent: unknown) => {\r\n                    // eslint-disable-next-line no-bitwise\r\n                    fs.access(directoryPath, fs.constants.F_OK | fs.constants.W_OK, (err: ErrnoException | null) => {\r\n                        try {\r\n                            if (err && err.code === 'ENOENT') {\r\n                                fs.mkdirSync(directoryPath);\r\n                                fs.chmodSync(directoryPath, 0o770);\r\n                            }else if (err && err.code === 'EPERM') {\r\n                                fs.chmodSync(directoryPath, 0o770);\r\n                            }\r\n                            fs.writeFileSync(`${directoryPath}/ui_settings.wnls`, wnlsContent);\r\n                            console.log(`Write ${directoryPath}/ui_settings.wnls success!`);\r\n                        } catch (e) {\r\n                            console.error(e);\r\n                        }\r\n                    });\r\n                };\r\n                App.mainWindow.loadURL(`http://localhost:${portNumber}/sso-offline-login?token=\"123\"`).then(() => {\r\n                    ipcMain.handle('save-wnls-data', saveWnlsDataHandler);\r\n                });\r\n                App.mainWindow.webContents.on('will-prevent-unload', () => {\r\n                    console.log('App.mainWindow.webContents will-prevent-unload');\r\n                    forkedProcess.send('UI_QUIT');\r\n                    App.application.quit();\r\n                    process.exit(0);\r\n                });\r\n                App.mainWindow.webContents.on('did-finish-load', () => {\r\n                    fs.access(directoryPath, fs.constants.R_OK, (err: ErrnoException | null) => {\r\n                        try {\r\n                            if (err && err.code === 'EPERM') fs.chmodSync(directoryPath, 0o400);\r\n                            const data = fs.readFileSync(`${directoryPath}/ui_settings.wnls`);\r\n                            App.mainWindow.webContents.send('load-wnls-data', data.toString());\r\n                            console.log(`Load ${directoryPath}/ui_settings.wnls success!`);\r\n                        } catch (e) {\r\n                            console.error(e);\r\n                        }\r\n                    });\r\n                });\r\n                App.mainWindow.on('close', () => {\r\n                    ipcMain.removeHandler('save-wnls-data');\r\n                    ipcMain.handle('save-wnls-data', saveWnlsDataHandler);\r\n                    forkedProcess.send('UI_QUIT');\r\n                });\r\n            } else if (message.endsWith('.zip')) {\r\n                App.mainWindow.setTitle(`${App.mainWindow.getTitle().split('  /')[0]}  /  ${message}`);\r\n            }\r\n        });\r\n        console.log(`fork done`);\r\n    }\r\n\r\n    static main(app: Electron.App, browserWindow: typeof BrowserWindow) {\r\n        App.BrowserWindow = browserWindow;\r\n        App.application = app;\r\n\r\n        App.application.on('window-all-closed', App.onWindowAllClosed);\r\n        App.application.on('ready', App.onReady);\r\n        App.application.on('activate', App.onActivate);\r\n    }\r\n}\r\n","/**\r\n * This module is responsible on handling all the inter process communications\r\n * between the frontend to the electron backend.\r\n */\r\n\r\nimport { app, ipcMain } from 'electron';\r\nimport { environment } from '../../environments/environment';\r\n\r\nexport default class ElectronEvents {\r\n  static bootstrapElectronEvents(): Electron.IpcMain {\r\n    return ipcMain;\r\n  }\r\n}\r\n\r\nipcMain.handle('get-app-version', (event) => {\r\n  console.log(`Fetching application version... [v${environment.version}]`);\r\n\r\n  return environment.version;\r\n});\r\n\r\nipcMain.on('quit', (event, code) => {\r\n  app.exit(code);\r\n});\r\n","/**\r\n * This module is responsible on handling all the setup events that is submitted by squirrel.\r\n */\r\n\r\nimport { app } from 'electron';\r\nimport { spawn } from 'child_process';\r\nimport { resolve, join, basename } from 'path';\r\nimport { environment } from '../../environments/environment';\r\n\r\nexport default class SquirrelEvents {\r\n  private static isAppFirstRun = false;\r\n\r\n  private static appFolder = resolve(process.execPath, '..');\r\n  private static appRootFolder = resolve(SquirrelEvents.appFolder, '..');\r\n  private static updateExe = resolve(join(SquirrelEvents.appRootFolder, 'Update.exe'));\r\n  private static exeName = resolve(\r\n    join(SquirrelEvents.appRootFolder, 'app-' + environment.version, basename(process.execPath))\r\n  );\r\n\r\n  static handleEvents(): boolean {\r\n    if (process.argv.length === 1 || process.platform !== 'win32') {\r\n      return false;\r\n    }\r\n\r\n    switch (process.argv[1]) {\r\n      case '--squirrel-install':\r\n      case '--squirrel-updated':\r\n        SquirrelEvents.update(['--createShortcut', SquirrelEvents.exeName]);\r\n\r\n        return true;\r\n\r\n      case '--squirrel-uninstall':\r\n        SquirrelEvents.update(['--removeShortcut', SquirrelEvents.exeName]);\r\n\r\n        return true;\r\n\r\n      case '--squirrel-obsolete':\r\n        app.quit();\r\n\r\n        return true;\r\n\r\n      case '--squirrel-firstrun':\r\n        SquirrelEvents.isAppFirstRun = true;\r\n\r\n        return false;\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  static isFirstRun(): boolean {\r\n    return SquirrelEvents.isAppFirstRun;\r\n  }\r\n\r\n  private static update(args: Array<string>) {\r\n    try {\r\n      spawn(SquirrelEvents.updateExe, args, { detached: true }).on('close', () => setTimeout(app.quit, 1000));\r\n    } catch (error) {\r\n      setTimeout(app.quit, 1000);\r\n    }\r\n  }\r\n}\r\n","declare const __BUILD_VERSION__: string;\r\n\r\nexport const environment = {\r\n  production: false,\r\n  version: __BUILD_VERSION__,\r\n};\r\n","const logger = require('electron-log');\r\nconst os = require('os');\r\nconst MEGABIT = 1048576;\r\n\r\nexport default class OverridedLogger {\r\n    static overridLog(product: string, timeString: string) {\r\n        logger.transports.file.maxSize = MEGABIT * 100;\r\n        logger.transports.file.resolvePath = () => `${os.homedir()}/${product}-offline-data/offline-tool-${formateLogTime(timeString)}.log`;\r\n        console = logger.functions;\r\n    }\r\n};\r\n\r\nfunction formateLogTime(timeString: string) {\r\n    return timeString?.split('T')[0];\r\n}\r\n","module.exports = require(\"electron\");","module.exports = require(\"electron-log\");","module.exports = require(\"child_process\");","module.exports = require(\"fs\");","module.exports = require(\"os\");","module.exports = require(\"path\");","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import SquirrelEvents from './app/events/squirrel.events';\r\nimport ElectronEvents from './app/events/electron.events';\r\nimport { app, BrowserWindow } from 'electron';\r\nimport App from './app/app';\r\nimport OverridedLogger from '@oam/offline-backend-shared/lib/utils/logger';\r\n\r\nexport default class Main {\r\n  static initialize() {\r\n      // eslint-disable-next-line no-restricted-syntax\r\n    OverridedLogger.overridLog('vcu', new Date().toISOString());\r\n    if (SquirrelEvents.handleEvents()) {\r\n      app.quit();\r\n    }\r\n  }\r\n\r\n  static bootstrapApp() {\r\n    App.main(app, BrowserWindow);\r\n  }\r\n\r\n  static bootstrapAppEvents() {\r\n    ElectronEvents.bootstrapElectronEvents();\r\n\r\n      // eslint-disable-next-line no-empty\r\n    if (!App.isDevelopmentMode()) {\r\n\r\n    }\r\n  }\r\n}\r\n\r\nMain.initialize();\r\n\r\nMain.bootstrapApp();\r\nMain.bootstrapAppEvents();\r\n"],"names":[],"sourceRoot":""}